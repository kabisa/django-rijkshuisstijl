{"version":3,"sources":["webpack:///./rijkshuisstijl/js/components/tabs/tabs.js"],"names":["Tabs","node","listItems","BEM","getChildBEMNodes","BLOCK_TABS","ELEMENT_LIST_ITEM","links","ELEMENT_LINK","track","getChildBEMNode","ELEMENT_TRACK","tabs","ELEMENT_TAB","bindEvents","activateHashLinkTab","activateCurrentTab","forEach","link","bindLink","window","addEventListener","bind","onClick","id","getActiveTabId","activateTab","location","hash","replace","document","getElementById","classList","contains","getBEMClassName","listener","scrollTo","removeEventListener","tabId","dataset","e","preventDefault","target","attributes","href","value","history","pushState","title","find","listItem","getListItemByLink","tabIndex","findIndex","tab","removeModifier","MODIFIER_ACTIVE","addModifier","Object","entries","_leaflet_events","event_name","callback","indexOf","listItemClassName","i","parentElement","console","error","TABS"],"mappings":"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","file":"tabs.bundle.js","sourcesContent":["import BEM from 'bem.js';\nimport {\n    BLOCK_TABS,\n    ELEMENT_LINK,\n    ELEMENT_LIST_ITEM,\n    ELEMENT_TAB,\n    ELEMENT_TRACK,\n    MODIFIER_ACTIVE,\n    TABS\n} from './constants';\n\n/**\n * Contains logic for tabs.\n * @class\n */\nclass Tabs {\n    /**\n     * Constructor method.\n     * @param {HTMLElement} node\n     */\n    constructor(node) {\n        /** @type {HTMLElement} */\n        this.node = node;\n\n        /** @type {NodeList} */\n        this.listItems = BEM.getChildBEMNodes(this.node, BLOCK_TABS, ELEMENT_LIST_ITEM);\n\n        /** @type {NodeList} */\n        this.links = BEM.getChildBEMNodes(this.node, BLOCK_TABS, ELEMENT_LINK);\n\n        /** @type {NodeList} */\n        this.track = BEM.getChildBEMNode(this.node, BLOCK_TABS, ELEMENT_TRACK);\n\n        /** @type {NodeList} */\n        this.tabs = BEM.getChildBEMNodes(this.node, BLOCK_TABS, ELEMENT_TAB);\n\n        this.bindEvents();\n        if (!this.activateHashLinkTab()) {\n            this.activateCurrentTab();\n        }\n\n    }\n\n    /**\n     * Binds events to callbacks.\n     */\n    bindEvents() {\n        [...this.links].forEach(link => this.bindLink(link));\n        window.addEventListener('popstate', this.activateHashLinkTab.bind(this));\n        window.addEventListener('resize', this.activateCurrentTab.bind(this));\n    }\n\n    /**\n     * Binds link click to callback.\n     * @param {HTMLAnchorElement} link\n     */\n    bindLink(link) {\n        link.addEventListener('click', this.onClick.bind(this));\n    }\n\n    /**\n     * (Re)activates the active tab, or the first tab.\n     */\n    activateCurrentTab() {\n        let id = this.getActiveTabId();\n        if (id) {\n            this.activateTab(id);\n        }\n    }\n\n    /**\n     * (Re)activates the active tab, or the first tab.\n     */\n    activateHashLinkTab() {\n        const id = window.location.hash.replace('#', '');\n\n        const node = document.getElementById(id);\n        if (node && node.classList.contains(BEM.getBEMClassName(BLOCK_TABS, ELEMENT_TAB))) {\n            const listener = () => {\n                window.scrollTo(0, 0);\n                window.removeEventListener('scroll', listener);\n            };\n            window.addEventListener('scroll', listener);\n            this.activateTab(id);\n\n            return true;\n        }\n    }\n\n    /**\n     * Returns the active tab id (this.node.dataset.tabId) or the first tab's id.\n     * @returns {(string|void)}\n     */\n    getActiveTabId() {\n        let tabId = this.node.dataset.tabId;\n\n        if (tabId) {\n            return tabId;\n        } else {\n            try {\n                return this.tabs[0].id;\n            } catch (e) {\n            }\n        }\n\n    }\n\n    /**\n     * Handles link click event.\n     * @param {MouseEvent} e\n     */\n    onClick(e) {\n        e.preventDefault();\n        let link = e.target;\n        let id = link.attributes.href.value.replace('#', '');\n        history.pushState({}, document.title, link);\n        this.activateTab(id);\n    }\n\n    /**\n     * Activates tab with id.\n     * @param {string} id The id of the tab.\n     * @return {HTMLElement}\n     */\n    activateTab(id) {\n        let link = [...this.links].find(link => link.attributes.href.value === '#' + id);\n        let listItem = this.getListItemByLink(link);\n        let tabIndex = [...this.tabs].findIndex(tab => tab.id === id);\n        let tab = this.tabs[tabIndex];\n\n        [...this.listItems, ...this.tabs].forEach(node => BEM.removeModifier(node, MODIFIER_ACTIVE));\n        [listItem, tab].forEach(node => BEM.addModifier(node, MODIFIER_ACTIVE));\n        this.node.dataset.tabId = id;\n\n        // Support leaflet.\n        //\n        // Leaflet won't render correctly if not visible. Therefore, we need to invalidate it's size to re-render it.\n        // We don't have a direct reference to the leaflet instances so we try to find the callbacks in\n        // window._leaflet_events, then call it when activating the tab (if the even name matches resize).\n        //\n        // FIXME: There is probably a better way to do this.\n        try {\n            Object.entries(window._leaflet_events).forEach(([event_name, callback]) => {\n               if (event_name.indexOf('resize') > -1) {\n                    callback();\n               }\n            });\n        } catch (e) {}\n    }\n\n    /**\n     * Finds the list item containing link up the DOM tree.\n     * @param {HTMLAnchorElement} link\n     */\n    getListItemByLink(link) {\n        let listItemClassName = BEM.getBEMClassName(BLOCK_TABS, ELEMENT_LIST_ITEM);\n        let i = 0;\n\n        while (!link.classList.contains(listItemClassName)) {\n            link = link.parentElement;\n\n            if (i > 100) {\n                console.error('Failed to find list item');\n                break;\n            }\n        }\n        return link;\n    }\n}\n\n\n// Start!\n[...TABS].forEach(tabs => new Tabs(tabs));\n\n"],"sourceRoot":""}