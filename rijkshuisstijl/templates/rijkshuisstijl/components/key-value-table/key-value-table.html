{% load sniplates rijkshuisstijl %}{% singleline %}
    <aside class="key-value-table{% if class %} {{ class }}{% endif %}" id="{{ id }}">
        {% load_widgets form=sniplates|default:'rijkshuisstijl/components/form/sniplates.html' %}
        {% if form and not form_id %}
            <form class="form" {% if form_action %} action="{{ form_action }}"{% endif %} method="{{ form_method }}" enctype="{{ form_enctype }}">
            {% csrf_token %}
        {% endif %}

        {% for error in form.non_field_errors %}
            {% include 'rijkshuisstijl/components/form/errors.html' with class='errors--non-field' errors=error only %}
        {% endfor %}

        {% for title, fields in data %}
            <table class="key-value-table__table">
                {% if title %}
                    <thead class="key-value-table__header">
                    <tr class="key-value-table__row">
                        <th class="key-value-table__caption" colspan="2">{{ title }}</th>
                    </tr>
                    </thead>
                {% endif %}
                <tbody class="key-value-table__body">
                {% for field in fields %}
                    {% firstof id|add:'-'|add:field.key as id %}
                    <tr class="key-value-table__row{% if field.form_field and not field_toggle_edit or field.key in form.errors %} key-value-table__row--edit{% endif %}" id="{{ id }}">
                        <th class="key-value-table__key{% if field.form_field and field_toggle_edit %} toggle{% endif %}"
                                {% if field.form_field and field_toggle_edit %} data-toggle-target="#{{ id }}" data-toggle-modifier="edit"{% endif %}>{% firstof field.label field %}</th>
                        <td class="key-value-table__value">
                            {% if field.form_field and not field_toggle_edit %}
                                {% form_field field.form_field compact=True label=None form_id=form_id %}

                            {% elif field.form_field and field_toggle_edit %}

                                {% form_field field.form_field compact=True label=None form_id=form_id %}
                                <span class="toggle" data-toggle-target="#{{ id }}" data-toggle-modifier="edit">{{ object|format_value:field.key }}</span>

                            {% else %}
                                {{ object|format_value:field.key }}
                            {% endif %}
                        </td>
                    </tr>
                    {% if forloop.last and form %}
                        <tr class="key-value-table__row key-value-table__row--actions">
                            <td class="key-value-table__key"></td>
                            <td class="key-value-table__value">
                                {% button class='button--small button--primary' type="submit" label=_('Opslaan') form=form_id %}
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}
                </tbody>
            </table>
        {% endfor %}

        {% if form and not form_id %}
            </form>
        {% endif %}
    </aside>
{% endsingleline %}
